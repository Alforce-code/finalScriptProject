<%- include('../partials/header', { title: 'My Grades' }) %>

<h1>My Grades</h1>

<% if (typeof error !== 'undefined' && error) { %>
  <div class="alert alert-error"><%= error %></div>
<% } %>

<% if (semesterGrades && Object.keys(semesterGrades).length > 0) { %>
  <% Object.keys(semesterGrades).forEach(sem => { %>
    <div style="margin-top: 2rem;">
      <h2><%= sem %></h2>
      <table style="width: 100%; border-collapse: collapse; background: white;">
        <tr style="background-color: #f8f9fa;">
          <th style="padding: 0.75rem; border-bottom: 1px solid #ddd;">Module</th>
          <th style="padding: 0.75rem; border-bottom: 1px solid #ddd;">Final Grade</th>
          <th style="padding: 0.75rem; border-bottom: 1px solid #ddd;">Status</th>
        </tr>
        <% semesterGrades[sem].forEach(g => { %>
          <tr>
            <td style="padding: 0.75rem; border-bottom: 1px solid #ddd;">
              <%= g.module_name %>
            </td>
            <td style="padding: 0.75rem; border-bottom: 1px solid #ddd;">
              <span style="color: <%= g.final_score >= 50 ? 'green' : 'red' %>; font-weight: bold;">
                <%= g.final_score !== null ? g.final_score + '%' : 'N/A' %>
              </span>
            </td>
            <td style="padding: 0.75rem; border-bottom: 1px solid #ddd;">
              <% if (g.final_score === null) { %>
                <span style="color: #f39c12;">Not Graded</span>
              <% } else if (g.final_score >= 70) { %>
                <span style="color: #27ae60;">Distinction</span>
              <% } else if (g.final_score >= 60) { %>
                <span style="color: #3498db;">Credit</span>
              <% } else if (g.final_score >= 50) { %>
                <span style="color: #f39c12;">Pass</span>
              <% } else { %>
                <span style="color: #e74c3c;">Fail</span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </table>
    </div>
  <% }) %>
<% } else { %>
  <div class="alert alert-info">
    No grades available yet. Your grades will appear here once they are entered by your lecturers.
  </div>
<% } %>

<div style="margin-top: 2rem;">
  <a href="/student/dashboard" class="btn">Back</a>
</div>

<%- include('../partials/footer') %>
